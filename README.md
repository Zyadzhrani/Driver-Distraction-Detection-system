# 🚗 Driver Distraction Detection System

A real-time embedded system for detecting driver distractions using computer vision and deep learning on the Jetson Nano 4GB. This project was developed as part of the EE 499 Senior Design Project at King Abdulaziz University.

## 👨‍💻 Team Members
- Jawad Maimani – 2136574
- Zyad Alzahrani – 2138321
- Abdullah Alghamdi – 2136513

## 📘 Project Overview
Driver distraction is a major cause of road accidents. Our system detects four critical types of distractions:

### 1. Using a Mobile Phone
![Using mobile phone](Images/Using_mobile_phone.jpg)

### 2. Talking on the Phone (Left or Right Hand)
![Talking on the phone](Images/Talking_on_the_phone.jpg)

### 3. Talking to Passengers
![Talking to passenger](Images/Talking_to_passenger.jpg)

### 4. Not Holding the Steering Wheel
![Not holding wheel](Images/Not_holding_the_steering_wheel.jpg)

## 🧪 Testing Environment
We tested our system in multiple lighting and setup environments.
Below is a representative comparison:

![Test environment comparison](Images/Figure_Y_combined_square.jpg)

## 📑 Example Report
An example PDF report generated by the system:

👉 [Download Report Example](Report_Example.pdf)

## 🔧 Hardware Components
- Jetson Nano 4GB
- Arducam 1080p RGB-IR Camera
- Buzzer (with transistor circuit)
- Push Button (for generating PDF reports)
- USB Microphone
- Speaker for alerts
- 12V car power adapter
- Custom 3D printed mounts and case

## 🧠 Software & Tools
- YOLOv8s-OBB from Ultralytics
- OpenCV (Image capture and display)
- Shapely (Geometric calculations for OBB)
- Jetson.GPIO for GPIO interaction
- Threading + Subprocess for multitasking
- Python 3.8
- JetPack SDK + PyTorch + CUDA/cuDNN

## 🗂️ Features
- Real-time image capture every 30 seconds
- YOLOv8s-OBB based object detection with rotated bounding boxes
- Custom distraction analysis logic
- 2-second buzzer alert when a distraction is detected
- Button trigger to generate `PDF_FILE.py` report in a separate thread
- Automatic logging of distraction types and counts
- Deletes captured image after use to save disk space

## 📸 Classes Detected
| Class ID | Class Name               |
|----------|--------------------------|
| 0        | Talking to Passenger     |
| 1        | Hands                    |
| 3        | Using Mobile Phone       |
| 4        | Steering Wheel           |
| 6        | Talking on Phone (Left)  |
| 7        | Talking on Phone (Right) |
| 8        | Normal Face              |

## ▶️ How to Run

1. Activate the Python environment:
   ```bash
   source yolov8env/bin/activate
   ```

2. Run the main script:
   ```bash
   python3 Driver_dis_with_button.py
   ```

   > If you get memory errors, ensure swap is configured (`/swapfile`).

## 🧪 Validation
- Achieved over **91% mAP@0.5**
- Successfully deployed on Jetson Nano for real-time performance
- Robust under both day and night conditions using RGB + IR camera

## 📁 Directory Structure
```
Driver-Distraction-System/
├── Driver_dis_with_button.py
├── PDF_FILE.py
├── Yolov8s_OBB.pt
├── predictions/
│   └── annotated_*.jpg
├── captured_*.jpg (deleted automatically)
├── destraction_save.txt
├── Images/
│   ├── Using_mobile_phone.jpg
│   ├── Talking_on_the_phone.jpg
│   ├── Talking_to_passenger.jpg
│   └── Not_holding_the_steering_wheel.jpg
│   └── Figure_Y_combined_square.jpg
├── Report_Example.pdf
└── README.md
```

## ⚙️ Future Work
- Expand distraction classes (e.g., eating, drowsiness)
- Add dashboard for remote fleet management
- Integrate haptic or visual alerts
- Optimize for Jetson Orin Nano

---

## 📜 License
This project is part of the EE 499 Senior Design Course at King Abdulaziz University. Use is permitted for educational and non-commercial purposes only.
